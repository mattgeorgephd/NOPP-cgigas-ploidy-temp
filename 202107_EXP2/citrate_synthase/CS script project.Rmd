---
title: "CS_assay"
output: pdf_document
---
# Make new CS standard curve for new data (3/22/2022)
```{r}
CS_1<-read.csv("https://raw.githubusercontent.com/mattgeorgephd/NOPP-gigas-ploidy-temp/main/202107_EXP2/citrate_synthase/Raw%20Data/3.21.22%20Cs%20assay%20standards.csv")
#attach labels
#wells<-c(0, 8, 16, 24, 32, 40, "PC_2", "PC_10", "PC_20", "A1", "A1", "A1", "A2", "A2", "A2", "B1", "B1", "B1", "B2", "B2", "B2", "B3", "B3", "B3", "B4", "B4", "B4", "C1", "C1", "C1", "C2", "C2", "C2", "D2", "D2", "D2", "D3", "D3", "D3", "A3", "A3", "A3")
#wells<-c(0,0,0, 8, 8, 8, 16, 16, 16, 24, 24, 24, 32, 32, 32, 40, 40, 40, "pos", "pos", "pos", "R41", "R41", "R41", "R41", "R41", "M44", "M44", "M44", "M44", "M44", "R43", "R43", "R43", "R43", "R43", "BACK" , "BACK", "BACK")
wells<-c(0, 8, 16, 24, 32, 40, "R46", "R46", "R46", "M89", "M89", "M89", "M41", "M41", "M41", "D55", "D55", "D55", "D56", "D56", "D56", "X42", "X42", "X42", "T62", "T62", "T62", "T59", "T59", "T59", "D58", "D58", "D58", "R50", "R50", "R50", "R42", "R42", "R42", "R48", "R48", "R48", "T56", "T56", "T56", "X44", "X44", "X44", "R47", "R47", "R47", "N45", "N45", "N45", "N44", "N44", "N44", "X43", "X43", "X43", "M47", "M47", "M47", "T58", "T58", "T58", "N46", "N46", "N46", "T61", "T61", "T61", "D59", "D59", "D59", "POS", "POS", "POS", "BCKGRD", "BCKGRD", "BCKGRD")
CS<-CS_1[c(1:9)] #clean data
CS<-CS[-c(586),] #clean data
CS$Label<-rep(wells, 15) #label all replicates
CS$A<-CS$`Absorbance @ 405 (0.1s) (A)` #rename column A
#extract standards
cs_standards<-CS[c(1:14),] #removed outliers
standards<-as.numeric(c(0,0,0,8,8,8,16,16,16,24,24,24,32,32)) #relabel
cs_standards$Label<-standards
#view data
library(ggplot2)
library(dplyr)
library(ggpubr)
#plot CS standards
standard_plot<-ggplot(data=cs_standards,(aes(x=NEW.A, y=Label)))+geom_point()+geom_smooth(method="lm", se=FALSE, formula = y ~ poly(x, 1) )+xlab("Concentration of standard ug/mL")+ylab("A @ 570nm")+theme_bw()+stat_regline_equation(label.x=0.25, label.y=20)
#extract equation from chart
#y=0.27+21x
####Extract Data
samples<-c('M44', 'R43', 'R41')
positive<-subset(CS, Label == samples)
#view data
quickview2<-ggplot(data=positive, aes(x=Repeat, y=NEW.A, color=Label))+geom_point()+theme_bw()+geom_smooth(method="lm", se=FALSE, formula=y~x)
quickview2
####get CS results
time_0<-subset(CS, CS$Repeat==1)
time_50<-subset(CS, CS$Repeat==15) #pick maximum data point
initial<-time_0 %>% 
  group_by(Label) %>%
  summarise(meanA = mean(`NEW.A`))
final<-time_50 %>% 
  group_by(Label) %>%
  summarise(meanA = mean(`NEW.A`))
#####Calculate Delta OD
final<-final[c(8, 10,11),] #this will change each time
initial<-initial[c(8, 10, 11),] #this will change each time
deltaOD<-final$meanA-initial$meanA
results<-mutate(initial, OD=deltaOD) #OD is the delta OD for the samples


####get BSA data#####

bsa<-read.csv(file="https://raw.githubusercontent.com/mattgeorgephd/NOPP-gigas-ploidy-temp/main/202107_EXP2/citrate_synthase/Raw%20Data/BSA_3.21%20standards.csv")
bsa_standards<-(bsa[c(1:9)])
bsa_standards_2<-bsa_standards[c(1:17),]
#make plot

reverse_plot<-ggplot(data=bsa_standards,(aes(x=NEW.A, y=as.numeric(Label))))+geom_point()+geom_smooth(method="lm", se=FALSE, formula = y ~ x )+theme_bw()+stat_regline_equation(label.x=0.6, label.y=500)+ylab("ug/mL")

reverse_plot

#extract equation from plot
samples<-bsa_standards_2[c(9:17),]
A<-bsa_standards_2 %>% 
  group_by(Label) %>%
  summarise(meanA = mean(NEW.A))
A_samples<-A[c(9,10,11),]
protein_content<-(3000*A_samples$meanA)-620 #with no correction
weights<-c(10.8,19.1, 12.2) #from CS sample list 
V1<-350 #uL
standardization<-weights/V1 #mg/uL
P<-(protein_content/standardization)/1000/1000 #ug/ml, ug/uL, mg/uL  also equal to total protein extracted 
# BSA_results<-mutate(A_samples, protein_content, weights, standardization, protein_standardization)
BSA_results<-mutate(A_samples, protein_content, weights, standardization)

######Calculate Final Values
t<-55 #min
m<-21
b<-0.27
GSH<-(m*deltaOD)+b 
V<-50 #uL from procedure 
D<-1 #dilution coefficient, should be 1 since we did not dilute
CS_activity<-(GSH/(t*V))*D/P
results<-mutate(initial, OD=deltaOD, GSH=GSH, weights, protein_content, standardization, "Protein (mg/ul)"=P, "CS activity (nmol/(mg*min))"=CS_activity  ) #OD is the delta OD for the samples
```


