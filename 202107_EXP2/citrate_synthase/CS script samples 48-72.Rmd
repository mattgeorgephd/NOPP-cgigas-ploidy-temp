---
title: "CS script samples 49-72"
author: "Olivia Cattau"
date: '2022-07-08'
output: pdf_document
---
# Make new CS standard curve for new data (3/22/2022)
```{r}
library(ggplot2)
library(dplyr)
library(ggpubr)
CS_1<-read.csv("https://raw.githubusercontent.com/mattgeorgephd/NOPP-gigas-ploidy-temp/main/202107_EXP2/citrate_synthase/Raw%20Data/3.22.22%20CS%20activity%201-23.csv") #standards, and samples 1-23 only
CS_3<-read.csv("https://raw.githubusercontent.com/mattgeorgephd/NOPP-gigas-ploidy-temp/main/202107_EXP2/citrate_synthase/Raw%20Data/CS%20activity%203.22.22%2049-72.csv") #samples 49 to 72 only 
#attach labels
wells<-c(0, 8, 16, 24, 32, 40, "R46", "R46", "R46", "M89", "M89", "M89", "M41", "M41", "M41", "D55", "D55", "D55", "D56", "D56", "D56", "X42", "X42", "X42", "T62", "T62", "T62", "T59", "T59", "T59", "D58", "D58", "D58", "R50", "R50", "R50", "R42", "R42", "R42", "R48", "R48", "R48", "T56", "T56", "T56", "X44", "X44", "X44", "R47", "R47", "R47", "N45", "N45", "N45", "N44", "N44", "N44", "X43", "X43", "X43", "M47", "M47", "M47", "T58", "T58", "T58", "N46", "N46", "N46", "T61", "T61", "T61", "D59", "D59", "D59", "POS", "POS", "POS", "BCKGRD", "BCKGRD", "BCKGRD")
wells3<-c("N58", "N58", "N58", "R53", "R53", "R53", "R56", "R56", "R56", "N48", "N48", "N48", "N51", "N51", "N51", "N54", "N54", "N54", "R51", "R51", "R51", "N56", "N56", "N56", "R57", "R57", "R57", "N53", "N53", "N53", "N57", "N57", "N57", "X46", "X46", "X46", "N52", "N52", "N52", "R54", "R54", "R54", "R59", "R59", "R59", "N50", "N50", "N50", NA, NA, NA, "R52", "R52", "R52", "N55", "N55", "N55", "M45", "M45", "M45", "empty" )
CS<-CS_1[-c(811,812),] #clean data
names(CS)[7]<-'Label'
names(CS)[6]<-'A'
CS_3['Label'] <- NA
names(CS_3)[7]<-'Label'
names(CS_3)[6]<-'A'
CS$Label<-rep(wells, 10) #label all replicates
CS_3$Label<-rep(wells3, 12) #note rep=12 not 10
#extract standards
cs_standards<-CS[c(2:6),] #removed outliers
standards<-as.numeric(c(8, 16, 24, 32, 40)) #relabel
cs_standards$Label<-standards
#view data
#plot CS standards
standard_plot<-ggplot(data=cs_standards,(aes(x=A, y=Label)))+geom_point()+geom_smooth(method="lm", se=FALSE, formula = y ~ poly(x, 1) )+xlab("Concentration of standard ug/mL")+ylab("A @ 570nm")+theme_bw()+stat_regline_equation(label.x=0.25, label.y=20)
#extract equation from chart
#y=4.1 +83x
###View controls
controls<-c(0,'BCKGRD', 'POS')
controls2<-subset(CS, Label == controls)
quickview<-ggplot(data=controls2, aes(x=Repeat, y=A, color=Label))+geom_point()+theme_bw()+geom_smooth(method="lm", se=FALSE, formula=y~x)
quickview
#based on controls, I would subtract Repeat 12 values from Repeat 1 values without subtracting 0s from dataset
####Extract Data
samples3<-c("N58", "R53","R56",  "N48",  "N51",  "N54",  "R51", "N56",  "R57", "N53", "N57", "X46", "N52", "R54", "R59", "N50", "R52", "N55", "M45", "empty")
mydata3<-filter(CS_3, CS_3$Label %in% samples3)
#view data
quickview4<-ggplot(data=mydata3, aes(x=Repeat, y=A, color=(Label)))+geom_point()+theme_bw()+geom_smooth(method="lm", se=FALSE, formula=y~x)+scale_x_continuous(breaks=seq(1, 12, by=1))
quickview4 #looks great!

###Get CS results###
time_i<-subset(CS_3, CS_3$Repeat==1)
time_f<-subset(CS_3, CS_3$Repeat==12) #pick maximum data point
initial<-time_i %>% 
  group_by(Label) %>%
  summarise(meanA = mean(A))
final<-time_f %>% 
  group_by(Label) %>%
  summarise(meanA = mean(A))
#####Calculate Delta OD
final<-final[-c(1, 21),] #this will change each time
initial<-initial[-c(1, 21),] #this will change each time
deltaOD<-final$meanA-initial$meanA
results<-mutate(initial, OD=deltaOD) #OD is the delta OD for the samples


####get BSA data#####

bsa<-read.csv(file="https://raw.githubusercontent.com/mattgeorgephd/NOPP-gigas-ploidy-temp/main/202107_EXP2/citrate_synthase/Raw%20Data/BSA%203.22.22%2049-70.csv")
names(bsa)[6]<-'A'
w<-c("N58", "N58", "N58", "R53", "R53", "R53", "N48", "N48", "N48", "N51", "N51", "N51", "N54", "N54", "N54", "N51", "N51", "N51", "N56", "N56", "N56", "R57", "R57", "R57", "N53", "N53", "N53", "N57", "N57", "N57", "X46", "X46", "X46", "N52", "N52", "N52", "R56", "R56", "R56", "R54", "R54", "R54", "R59", "R59", "R59", "N50", "N50", "N50", "R55", "R55", "R55", "R52", "R52", "R52", "N55", "N55", "N55", "M45", "M45", "M45", "empty", "empty", "empty")
bsa$Label<-rep(w, 3)

#reverse_plot (from samples 1-23)
#y=-2300 +2800x

#extract equation from plot
A<-bsa %>% 
  group_by(Label) %>%
  summarise(meanA = mean(A))
A_samples<-A[-c(1),]
protein_content<-(2800*A_samples$meanA)-2300 #with no correction
sample_list<-read.csv("https://raw.githubusercontent.com/mattgeorgephd/NOPP-gigas-ploidy-temp/main/202107_EXP2/citrate_synthase/Raw%20Data/weights.csv")
joined<-inner_join(A_samples, sample_list, by="Label") #from CS sample list 
weights<-joined$Weights 
V1<-350 #uL
standardization<-weights/V1 #mg/uL
P<-(protein_content/standardization)/1000/1000 #ug/ml, ug/uL, mg/uL  also equal to total protein extracted 

BSA_results<-mutate(A_samples, protein_content, weights, standardization)

######Calculate Final Values 
#y=4.1 +83x (CS activity)
t<-50 #min
m<-83
b<-4.1
GSH<-(m*deltaOD)+b 
V<-50 #uL from procedure 
D<-1 #dilution coefficient, should be 1 since we did not dilute
CS_activity<-(GSH/(t*V))*D/P
results<-mutate(initial, OD=deltaOD, GSH=GSH, weights, protein_content, standardization, "Protein (mg/ul)"=P, "CS activity (nmol/(mg*min))"=CS_activity) #OD is the delta OD for the samples

ploidy<-read.csv(file="https://raw.githubusercontent.com/mattgeorgephd/NOPP-gigas-ploidy-temp/main/202107_EXP2/citrate_synthase/Raw%20Data/ploidy.csv")
names(ploidy)[1]<-'Label'

treatment<-read.csv(file="https://raw.githubusercontent.com/mattgeorgephd/NOPP-gigas-ploidy-temp/main/202107_EXP2/citrate_synthase/Raw%20Data/treatments.csv")
trt<-treatment[c(1:72),]
names(trt)[2]<-'Label'
results_joined<-inner_join(results, ploidy , by="Label") #from CS sample list 
results_joined<-inner_join(results_joined, trt, by="Label")

final_plot<-ggplot(data=results_joined,(aes(x=weights, y=results_joined$`CS activity (nmol/(mg*min))`, color=trt)))+geom_point()+theme_bw()+geom_smooth(method="lm", se=FALSE, formula = y ~ x ) + ylab("CS Activity (nmol/(mg*min))")


```


